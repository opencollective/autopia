<% if current_account %>
  <p>    
    <% if current_account.open_to.count > 0 %>
      You're open to:
      <%=current_account.open_to.map { |x| %Q{<a href="/dating?open_to_#{x}=true" class="text-white label label-primary">#{x == 'non_monogamy' ? 'Non-monogamy' : x.humanize}</a>} }.join(' ') %>
      <a href="/accounts/edit">Change</a>
    <% else %>
      <a href="/accounts/edit">Choose what you're open to</a>
    <% end %>
  </p>
<% end %>

<form action="/dating" id="search-form">

  <% Account.radio_scopes.each_with_index { |el,i| k,v,t,r = *el %>
    <div class="radio-inline ml-3 mb-2">
      <%= radio_button_tag k, :value => v, :checked => (params[k] == v.to_s), :onclick => 'this.form.submit()', :id => "#{k}-#{v}" %>
      <label for="<%=k%>-<%=v%>">
        <%=t%>
      </label>
    </div>
  <% } %>    

  <% Account.check_box_scopes.each_with_index { |el,i| k,t,r = *el %>
    <div class="checkbox-inline ml-3 mb-2">
      <%= check_box_tag k, :value => true, :checked => params[k], :onclick => 'this.form.submit()', :id => k %>
      <label for="<%=k%>">
        <%=t%>&nbsp;<strong><%=r.count%></strong>
      </label>
    </div>        
  <% } %>      

</form>

<% if Account.open_to.any? { |x| params[:"open_to_#{x}"] } %>
  <ul class="search-result-list">

    <% @accounts.each { |account|  %>
      <li>
        <%= partial 'accounts/search_result', :locals => {:account => account} %>
      </li>
    <% } %>

  </ul>

  <div class="mt-3">
    <%= will_paginate @accounts, :renderer => WillPaginate::ViewHelpers::BootstrapRenderer %>
  </div>

<% end %>

